<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MBBS Flashcards</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 2rem;
      background-color: #f0f8ff;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #0077b6;
    }

    .card-form, .quiz-section, .card-list {
      max-width: 600px;
      margin: auto;
      margin-bottom: 2rem;
      background: white;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    input, select {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      padding: 0.6rem 1.2rem;
      background-color: #0077b6;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 5px;
    }

    .flashcard {
      background: #e0f7fa;
      padding: 1rem;
      margin: 0.5rem 0;
      border-radius: 8px;
    }

    .flashcard-actions {
      margin-top: 0.5rem;
    }

    .quiz-section input {
      margin-top: 1rem;
    }

    #timer {
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>MBBS Flashcards</h1>

  <div class="card-form">
    <h3>Add a Flashcard</h3>
    <input type="text" id="question" placeholder="Enter question">
    <input type="text" id="answer" placeholder="Enter answer">
    <input type="text" id="subject" placeholder="Enter subject (e.g. Anatomy)">
    <button onclick="addFlashcard()">Add</button>
  </div>

  <div class="card-list">
    <h3>My Flashcards</h3>
    <label for="filterSubject">Filter by Subject:</label>
    <select id="filterSubject" onchange="renderCards()">
      <option value="">All</option>
    </select>
    <div id="cardsContainer"></div>
  </div>

  <div class="quiz-section">
    <h3>Quiz Mode</h3>
    <label for="quizSubject">Choose Subject:</label>
    <select id="quizSubject" onchange="resetQuiz()">
      <option value="">All</option>
    </select>
    <div id="quizCard"></div>
    <input type="text" id="userAnswer" placeholder="Your answer">
    <button onclick="checkAnswer()">Check</button>
    <button onclick="skipQuestion()">Skip</button>
    <p id="quizFeedback"></p>
    <p id="timer">Time left: 60s</p>
  </div>

  <script>
    let flashcards = [];
    let currentQuizIndex = 0;
    let quizCards = [];
    let timer;
    let timeLeft = 60;

    function saveToLocalStorage() {
      localStorage.setItem("mbbsFlashcards", JSON.stringify(flashcards));
    }

    function loadFromLocalStorage() {
      const data = localStorage.getItem("mbbsFlashcards");
      if (data) {
        flashcards = JSON.parse(data);
      }
    }

    function addFlashcard() {
      const question = document.getElementById("question").value.trim();
      const answer = document.getElementById("answer").value.trim();
      const subject = document.getElementById("subject").value.trim();
      if (!question || !answer || !subject) return alert("All fields required");
      flashcards.push({ question, answer, subject });
      saveToLocalStorage();
      document.getElementById("question").value = "";
      document.getElementById("answer").value = "";
      document.getElementById("subject").value = "";
      renderCards();
      populateSubjectDropdowns();
      resetQuiz();
    }

    function deleteFlashcard(index) {
      if (confirm("Delete this flashcard?")) {
        flashcards.splice(index, 1);
        saveToLocalStorage();
        renderCards();
        populateSubjectDropdowns();
        resetQuiz();
      }
    }

    function editFlashcard(index) {
      const newQ = prompt("Edit Question:", flashcards[index].question);
      const newA = prompt("Edit Answer:", flashcards[index].answer);
      const newS = prompt("Edit Subject:", flashcards[index].subject);
      if (newQ !== null && newA !== null && newS !== null) {
        flashcards[index] = { question: newQ.trim(), answer: newA.trim(), subject: newS.trim() };
        saveToLocalStorage();
        renderCards();
        populateSubjectDropdowns();
        resetQuiz();
      }
    }

    function renderCards() {
      const container = document.getElementById("cardsContainer");
      const filter = document.getElementById("filterSubject").value.toLowerCase();
      container.innerHTML = "";
      const uniqueSubjects = new Set();

      flashcards.forEach((card, index) => {
        uniqueSubjects.add(card.subject);
        if (!filter || card.subject.toLowerCase() === filter) {
          const div = document.createElement("div");
          div.className = "flashcard";
          div.innerHTML = `<strong>${card.question}</strong><br><em>Subject: ${card.subject}</em><br><em>Click to see answer</em>`;
          div.onclick = () => alert(`Answer: ${card.answer}`);

          const actions = document.createElement("div");
          actions.className = "flashcard-actions";

          const editBtn = document.createElement("button");
          editBtn.textContent = "Edit";
          editBtn.onclick = (e) => {
            e.stopPropagation();
            editFlashcard(index);
          };

          const deleteBtn = document.createElement("button");
          deleteBtn.textContent = "Delete";
          deleteBtn.onclick = (e) => {
            e.stopPropagation();
            deleteFlashcard(index);
          };

          actions.appendChild(editBtn);
          actions.appendChild(deleteBtn);
          div.appendChild(actions);
          container.appendChild(div);
        }
      });
    }

    function populateSubjectDropdowns() {
      const quizDropdown = document.getElementById("quizSubject");
      const filterDropdown = document.getElementById("filterSubject");
      const subjects = [...new Set(flashcards.map(c => c.subject))];

      [quizDropdown, filterDropdown].forEach(dropdown => {
        const selected = dropdown.value;
        dropdown.innerHTML = `<option value="">All</option>`;
        subjects.forEach(subject => {
          const option = document.createElement("option");
          option.value = subject;
          option.textContent = subject;
          if (subject === selected) option.selected = true;
          dropdown.appendChild(option);
        });
      });
    }

    function startTimer() {
      clearInterval(timer);
      timeLeft = 60;
      document.getElementById("timer").innerText = `Time left: ${timeLeft}s`;
      timer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = `Time left: ${timeLeft}s`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          skipQuestion();
        }
      }, 1000);
    }

    function resetQuiz() {
      const selectedSubject = document.getElementById("quizSubject").value;
      quizCards = selectedSubject
        ? flashcards.filter(c => c.subject === selectedSubject)
        : [...flashcards];
      currentQuizIndex = 0;
      showNextQuizCard();
    }

    function showNextQuizCard() {
      if (quizCards.length === 0) {
        document.getElementById("quizCard").innerText = "No flashcards available for this subject.";
        return;
      }
      const card = quizCards[currentQuizIndex];
      document.getElementById("quizCard").innerText = `${card.question} (Subject: ${card.subject})`;
      document.getElementById("userAnswer").value = "";
      document.getElementById("quizFeedback").innerText = "";
      startTimer();
    }

    function checkAnswer() {
      clearInterval(timer);
      const userAns = document.getElementById("userAnswer").value.trim().toLowerCase();
      const correctAns = quizCards[currentQuizIndex].answer.toLowerCase();
      const feedback = document.getElementById("quizFeedback");
      if (userAns === correctAns) {
        feedback.innerText = "Correct!";
      } else {
        feedback.innerText = `Wrong. Correct answer is: ${quizCards[currentQuizIndex].answer}`;
      }
      currentQuizIndex = (currentQuizIndex + 1) % quizCards.length;
      setTimeout(showNextQuizCard, 2000);
    }

    function skipQuestion() {
      clearInterval(timer);
      currentQuizIndex = (currentQuizIndex + 1) % quizCards.length;
      showNextQuizCard();
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadFromLocalStorage();
      renderCards();
      populateSubjectDropdowns();
      resetQuiz();
    });
  </script>
</body>
</html>
